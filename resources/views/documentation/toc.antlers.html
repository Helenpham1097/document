<aside class="sticky top-[calc(10vh-1rem)] hidden h-[calc(100vh-5rem)] w-1/6 flex-col overflow-y-auto pb-6 lg:flex" id="table-of-contents">
	<div class="flex items-center space-x-2 pb-4 font-bold text-zinc-800 dark:text-zinc-200">
		<span>On this page</span>
		{{ svg src="{{config:iconamic:path}}/list-tree.svg" class='size-4  text-zinc-800 dark:text-zinc-100 flex-none' }}
	</div>
	<div id="sidebar" class="pl-0">
		{{ content | toc }}
	</div>
</aside>

<script>
	let lastId = null;

	window.addEventListener("DOMContentLoaded", () => {
		const observer = new IntersectionObserver((entries) => {
			entries.forEach((entry) => {
				const id = entry.target.getAttribute("id");
				if (entry.intersectionRatio > 0) {
					document.querySelector(`#sidebar a[href="#${id}"]`).classList.add("text-purple-500", "dark:text-green-200");
					if (lastId) {
						document.querySelector(`#sidebar a[href="#${lastId}"]`).classList.remove("font-bold");
					}
					document.querySelector(`#sidebar a[href="#${id}"]`).classList.add("font-bold");
					lastId = id;
				} else {
					document.querySelector(`#sidebar a[href="#${id}"]`).classList.remove("text-purple-500", "dark:text-green-200");
				}
			});
		});

		// Track all sections that have an `id` applied
		document.querySelectorAll("section[id], h2[id], h3[id]").forEach((section) => {
			observer.observe(section);
		});
	});
</script>
